/*! mobile-select-area tianxiangbing http://www.lovewebgames.com/jsmodule/mobile-select-area.html 2015-04-01 */
function MobileSelectArea(){var a=Math.random().toString().replace(".","");this.id="scroller_"+a,this.scroller,this.data,this.index=0,this.value=[0,0,0],this.oldvalue,this.text=["","",""],this.level=3,this.mtop=30}MobileSelectArea.prototype={init:function(a){this.settings=$.extend({},a),this.trigger=this.settings.trigger,this.trigger.attr("readonly","readonly"),this.value=this.settings.value&&this.settings.value.split(",")||[0,0,0],this.oldvalue=this.value.concat([]),this.getData(),this.bindEvent()},getData:function(){var a=this;"object"==typeof this.settings.data?this.data=this.settings.data:$.ajax({dataType:"json",cache:!0,url:this.settings.data,type:"GET",success:function(b){a.data=b.data},accepts:{json:"application/json, text/javascript, */*; q=0.01"}})},bindEvent:function(){var a=this;this.trigger.tap(function(){$.confirm('<div class="ui-scroller-mask"><div id="'+a.id+'" class="ui-scroller"><div></div><div ></div><div></div><p></p></div></div>',null,function(b){"yes"==b&&a.submit(),(b="no")&&a.cancel(),this.dispose()}),a.scroller=$("#"+a.id),a.format();var b=0,c=0;return a.scroller.children().bind("touchstart",function(a){b=a.changedTouches[0].pageY}),a.scroller.children().bind("touchmove",function(a){c=a.changedTouches[0].pageY;var d=c-b,e=$(a.target).parent();if("DL"==e[0].nodeName){var f=parseInt(e.css("top")||0)+d;return e.css("top",f),b=c,!1}}),a.scroller.children().bind("touchend",function(d){c=d.changedTouches[0].pageY;var e=c-b,f=$(d.target).parent();if("DL"==f[0].nodeName){var g=$(f.parent()).index(),h=parseInt(f.css("top")||0)+e;h>a.mtop&&(h=a.mtop),h<-$(f).height()+60&&(h=-$(f).height()+60);var i=h/a.mtop,j=Math.round(i),k=Math.abs(j)+1;1==j&&(k=0),a.value[g]=$(f.children().get(k)).attr("ref"),a.text[g]=0==a.value[g]?"":$(f.children().get(k)).html();for(var l=a.data.length-1;l>g;l--)a.value[l]=0,a.text[l]="";return $(f.children().get(k)).hasClass("focus")||a.format(),$(f.children().get(k)).addClass("focus").siblings().removeClass("focus"),f.css("top",j*a.mtop),!1}}),!1})},format:function(){{var a=this;a.scroller.children()}this.f(this.data)},f:function(a){var b=this,c=a;c||(c=[]);var d,e='<dl><dd ref="0">——</dd>',f=0,g=b.mtop;if(0!==b.index&&"0"==b.value[b.index-1])e='<dl><dd ref="0" class="focus">——</dd>',b.value[b.index]=0,b.text[b.index]="",f=0;else{"0"==b.value[b.index]&&(e='<dl><dd ref="0" class="focus">——</dd>',f=0);for(var h=0,i=c.length;i>h;h++){var j=c[h].pid||0,k=c[h].id||0,l="";b.value[b.index]==k&&(l="focus",f=k,d=c[h].child,g=b.mtop*-h),e+='<dd pid="'+j+'" class="'+l+'" ref="'+k+'">'+c[h].name+"</dd>"}}e+="</dl>";var m=$(e);m.css("top",g);var n=b.scroller.children();return $(n[b.index]).html(m),b.index++,b.index>b.level-1?void(b.index=0):void b.f(d)},submit:function(){this.oldvalue=this.value.concat([]),1==this.trigger[0].nodeType&&(this.trigger.val(this.text.join(" ")),this.trigger.attr("data-value",this.value.join(","))),this.trigger.next(":hidden").val(this.value.join(",")),this.settings.callback&&this.settings.callback(this.scroller)},cancel:function(){this.value=this.oldvalue.concat([])}};